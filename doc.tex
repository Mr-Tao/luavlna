\documentclass{ltxdoc}
\usepackage{fontspec}
\setmainfont[Ligatures=TeX]{Linux Libertine O}
\usepackage[czech]{babel}
\usepackage{url}
\usepackage{hyperref}
\input prevent-single
\begin{document}
\title{prevent-single.tex}
\author{Michal Hoftich}
\maketitle
\section{Introduction}

This is small package for plain luatex. In some languages, like
Czech or Polish, there should be no single letter words at the line
end, according to the typographical norms. There exists some
external commands (like \verb!vlna!) or packages (\verb!encxvlna!
for \verb!enctex!, \verb!xevlna! for Xe\TeX,
\verb!impnattypo! for lua\LaTeX). This package is for plain
luatex.

The code is modified version of Patrick Gundlach's answer on
TeX.sx%
\footnote{\url{http://tex.stackexchange.com/a/28128/2891}}.
Difference is that it is possible to specify which single letters
should be taken into account and the code works also for single
letters at the beginning of the brackets.

\section{Usage}

The usage is simple:

\begin{verbatim}
\input ucode
\uselanguage{czech}
% in the case of luacsplain, use instead:
% \chyph
\input prevent-single
\preventsingledebugon
\input luaotfload.sty
\font\hello={name:Linux Libertine O:+rlig;+clig;+liga;+tlig} at 12pt 
\hsize=3in
\hello
Příliš žluťoučký kůň úpěl ďábelské ódy. 
Text s krátkými souhláskami a samohláskami i dalšími jevy z nabídky možností (v textu možnými). 

Grafika, ffinance -- pomlčka a tak.

I začátek odstavce je třeba řešit, i když výskyt zalomení není pravděpodobný.

Co třeba í znaky š diakritikou?

\preventsingledebugoff
Různé možnosti [v závorkách <a jiných znacích
\bye
\end{verbatim}

\noindent\parbox{3in}{%
\preventsingledebugon

Příliš žluťoučký kůň úpěl ďábelské ódy. 
Text s krátkými souhláskami a samohláskami i dalšími jevy z nabídky možností (v textu možnými). 

Grafika, ffinance -- pomlčka a tak.

I začátek odstavce je třeba řešit, i když výskyt zalomení není pravděpodobný.

Co třeba í znaky š diakritikou?

\preventsingledebugoff
Různé možnosti [v závorkách <a jiných znacích

\preventsingledebugoff
}

\bigskip
It is also possible to use the package with lua\LaTeX, just use

\begin{verbatim}
	\input prevent-single
\end{verbatim}

in the preamble.

\section{Commands}

\begin{verbatim}
\singlechars{#1} 
\end{verbatim}

Enable this feature only for certain letters. By default, all
single letters are processed, this command can be used to pass a
string of characters, which should be processed only.

\begin{verbatim}
\preventsingledebugon
\preventsingledebugoff
\end{verbatim}

Insert debugging marks on/off. Default off.
\end{document}
